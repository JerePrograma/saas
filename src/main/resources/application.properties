# ==============================
# Server / Web
# ==============================
server.port=8080
# Si queres cambiar el prefijo de todos los endpoints:
# server.servlet.context-path=/

# Forzar que la app sea MVC (Servlet) aunque haya WebFlux en el classpath
spring.main.web-application-type=servlet

# ==============================
# Datasource - PostgreSQL
# ==============================
spring.datasource.url=jdbc:postgresql://localhost:5432/saas
spring.datasource.username=postgres
spring.datasource.password=root
spring.datasource.driver-class-name=org.postgresql.Driver

# ==============================
# JPA / Hibernate
# ==============================
# Usamos Flyway para el schema, asi que validamos contra las entidades
spring.jpa.hibernate.ddl-auto=validate

spring.jpa.show-sql=false
spring.jpa.properties.hibernate.format_sql=false
spring.jpa.open-in-view=false

# Alineamos zona horaria de Hibernate (OffsetDateTime ? DB)
spring.jpa.properties.hibernate.jdbc.time_zone=UTC

# ==============================
# Flyway
# ==============================
spring.flyway.enabled=true
spring.flyway.locations=classpath:db/migration
# Si en algun momento corres Flyway sobre una BD ya existente:
# spring.flyway.baseline-on-migrate=true

# ==============================
# Jackson / Zona horaria
# ==============================
spring.jackson.time-zone=UTC

# ==============================
# Scheduler (webhook worker)
# ==============================
# Delay entre ejecuciones del worker de webhooks (ms)
ml.webhook.worker.delay-ms=5000

# Pool de threads para @Scheduled
spring.task.scheduling.pool.size=2

# ==============================
# Logging (Log4j2)
# ==============================
logging.level.root=INFO
logging.level.org.springframework.web=INFO
logging.level.org.springframework.data.jpa=INFO
logging.level.com.scalaris=DEBUG

# Log de SQL solo si lo necesitas para debug puntual:
# logging.level.org.hibernate.SQL=DEBUG
# logging.level.org.hibernate.type.descriptor.sql.BasicBinder=TRACE

# ==============================
# Actuator
# ==============================
management.endpoints.web.exposure.include=health,info,metrics
management.endpoint.health.show-details=when_authorized

logging.level.org.flywaydb=DEBUG

# Loguear excepciones y resolucion de errores en MVC
logging.level.org.springframework.web.servlet.DispatcherServlet=DEBUG
logging.level.org.springframework.web.servlet.mvc.method.annotation.ExceptionHandlerExceptionResolver=DEBUG
logging.level.org.springframework.boot.autoconfigure.web.servlet.error=DEBUG

# Hibernate: ver excepciones y (si queres) SQL
logging.level.org.hibernate=INFO
# logging.level.org.hibernate.SQL=DEBUG
# logging.level.org.hibernate.orm.jdbc.bind=TRACE
server.error.include-message=always
server.error.include-binding-errors=always
server.error.include-stacktrace=on_param
server.error.include-exception=true

app.tenancy.header=X-Tenant-Id
app.public-base-url=http://localhost:8080
app.quotations.share-path=/share/quote/
logging.level.org.springframework.security=DEBUG
